import React, { useState, useEffect } from 'react';
import { Menu, X, Globe, Heart, BookOpen, Users, Calendar, Phone, PlayCircle, MapPin, Mail, ChevronRight, Facebook, Youtube, Instagram, Loader2, CheckCircle } from 'lucide-react';
import { initializeApp } from 'firebase/app';
import { getFirestore, collection, addDoc, serverTimestamp } from 'firebase/firestore';
import { getAuth, signInAnonymously, onAuthStateChanged, signInWithCustomToken } from 'firebase/auth';

// --- Firebase Configuration & Initialization ---
// NOTE: When running locally, you will need to replace the variables below with your real Firebase config keys.
// For now, this code works in the preview environment.
const firebaseConfig = JSON.parse(__firebase_config);
const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);
const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';

// --- Components for each "Page" ---

const Home = ({ navigate }) => (
  <div className="animate-fade-in">
    {/* Hero Section */}
    <div className="relative bg-blue-900 text-white h-[80vh] flex items-center justify-center overflow-hidden">
      <div className="absolute inset-0 bg-black opacity-50 z-10"></div>
      <img 
        src="https://images.unsplash.com/photo-1438232992991-995b7058bbb3?ixlib=rb-1.2.1&auto=format&fit=crop&w=1950&q=80" 
        alt="Worship Background" 
        className="absolute inset-0 w-full h-full object-cover"
      />
      <div className="relative z-20 text-center px-4 max-w-4xl mx-auto">
        <h1 className="text-4xl md:text-6xl font-bold mb-6 font-serif tracking-tight">Walking in Newness of Life</h1>
        <p className="text-xl md:text-2xl mb-8 font-light text-gray-200">
          "Therefore we are buried with him by baptism into death: that like as Christ was raised up from the dead by the glory of the Father, even so we also should walk in newness of life." â€” Romans 6:4
        </p>
        <div className="flex flex-col md:flex-row gap-4 justify-center">
          <button onClick={() => navigate('contact')} className="bg-yellow-500 text-blue-900 hover:bg-yellow-400 font-bold py-3 px-8 rounded-full transition duration-300">
            Visit Us in Tarkwa
          </button>
          <button onClick={() => navigate('sermons')} className="bg-transparent border-2 border-white hover:bg-white hover:text-blue-900 text-white font-bold py-3 px-8 rounded-full transition duration-300">
            Watch Sermons
          </button>
        </div>
      </div>
    </div>

    {/* Welcome Section */}
    <section className="py-20 px-4 bg-white">
      <div className="max-w-6xl mx-auto text-center">
        <h2 className="text-3xl font-bold text-gray-800 mb-6">Welcome to Newness of Life Incorporated</h2>
        <div className="w-24 h-1 bg-yellow-500 mx-auto mb-8"></div>
        <p className="text-lg text-gray-600 leading-relaxed max-w-3xl mx-auto mb-10">
          We are a spirit-filled, bible-believing church headquartered in the golden city of Tarkwa, Ghana, with a mandate to reach the world. 
          Whether you are joining us from the Western Region or connecting with our global family online, we believe God has a new beginning for you.
        </p>
        <div className="grid grid-cols-1 md:grid-cols-3 gap-8 mt-12">
          <div onClick={() => navigate('ministries')} className="p-8 bg-gray-50 rounded-xl hover:shadow-xl transition cursor-pointer group">
            <div className="bg-blue-100 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4 group-hover:bg-blue-600 transition">
              <Users className="text-blue-600 group-hover:text-white" size={32} />
            </div>
            <h3 className="text-xl font-bold mb-2">Community</h3>
            <p className="text-gray-500">A family of believers united in love and purpose.</p>
          </div>
          <div onClick={() => navigate('beliefs')} className="p-8 bg-gray-50 rounded-xl hover:shadow-xl transition cursor-pointer group">
            <div className="bg-yellow-100 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4 group-hover:bg-yellow-500 transition">
              <BookOpen className="text-yellow-600 group-hover:text-white" size={32} />
            </div>
            <h3 className="text-xl font-bold mb-2">The Word</h3>
            <p className="text-gray-500">Uncompromising teaching of the Holy Scriptures.</p>
          </div>
          <div onClick={() => navigate('global')} className="p-8 bg-gray-50 rounded-xl hover:shadow-xl transition cursor-pointer group">
            <div className="bg-green-100 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4 group-hover:bg-green-600 transition">
              <Globe className="text-green-600 group-hover:text-white" size={32} />
            </div>
            <h3 className="text-xl font-bold mb-2">Global Mission</h3>
            <p className="text-gray-500">Taking the gospel from Tarkwa to the ends of the earth.</p>
          </div>
        </div>
      </div>
    </section>

    {/* Service Times Parallax */}
    <section className="py-20 bg-fixed bg-cover bg-center relative" style={{ backgroundImage: 'url("https://images.unsplash.com/photo-1544427920-c49ccfb85579?ixlib=rb-1.2.1&auto=format&fit=crop&w=1950&q=80")' }}>
      <div className="absolute inset-0 bg-blue-900 opacity-80"></div>
      <div className="relative z-10 max-w-4xl mx-auto text-white text-center px-4">
        <h2 className="text-3xl font-bold mb-8">Join Us for Service</h2>
        <div className="grid grid-cols-1 md:grid-cols-2 gap-8 text-left bg-white/10 p-8 rounded-lg backdrop-blur-sm border border-white/20">
          <div>
            <h3 className="text-xl font-bold text-yellow-400 mb-2">Sunday Service</h3>
            <p className="mb-1"><strong>First Service:</strong> 7:00 AM - 9:00 AM</p>
            <p><strong>Second Service:</strong> 9:30 AM - 11:30 AM</p>
          </div>
          <div>
            <h3 className="text-xl font-bold text-yellow-400 mb-2">Midweek Services</h3>
            <p className="mb-1"><strong>Wednesday (Teaching):</strong> 6:00 PM</p>
            <p><strong>Friday (Prayer Revival):</strong> 6:30 PM</p>
          </div>
        </div>
      </div>
    </section>
  </div>
);

const About = () => (
  <div className="animate-fade-in max-w-5xl mx-auto py-16 px-4">
    <h1 className="text-4xl font-bold text-gray-900 mb-8 text-center">Who We Are</h1>
    <div className="grid grid-cols-1 md:grid-cols-2 gap-12 items-center mb-16">
      <img src="https://images.unsplash.com/photo-1517048676732-d65bc937f952?ixlib=rb-1.2.1&auto=format&fit=crop&w=1000&q=80" alt="Church Meeting" className="rounded-lg shadow-lg" />
      <div>
        <h2 className="text-2xl font-bold text-blue-900 mb-4">Our History</h2>
        <p className="text-gray-600 mb-4 leading-relaxed">
          Newness of Life Incorporated was birthed in Tarkwa with a divine mandate to raise a generation of believers who walk in the reality of the resurrected Christ. From humble beginnings in the Western Region of Ghana, the Lord has expanded our territory, allowing us to touch lives across nations.
        </p>
        <p className="text-gray-600 leading-relaxed">
          We are more than a denomination; we are a movement dedicated to the total restoration of man's dignity through the preaching of the Gospel.
        </p>
      </div>
    </div>
    
    <div className="grid grid-cols-1 md:grid-cols-2 gap-8">
      <div className="bg-blue-50 p-8 rounded-xl border-l-4 border-blue-600">
        <h3 className="text-2xl font-bold text-blue-800 mb-4">Our Mission</h3>
        <p className="text-gray-700">
          To liberate the world from the oppression of darkness through the teaching of faith, the demonstration of the Spirit's power, and the tangible expression of God's love.
        </p>
      </div>
      <div className="bg-yellow-50 p-8 rounded-xl border-l-4 border-yellow-500">
        <h3 className="text-2xl font-bold text-yellow-800 mb-4">Our Vision</h3>
        <p className="text-gray-700">
          To see men and women everywhere walking in the newness of life, fully restored to God's original intent and purpose.
        </p>
      </div>
    </div>
  </div>
);

const Beliefs = () => (
  <div className="animate-fade-in max-w-4xl mx-auto py-16 px-4">
    <h1 className="text-4xl font-bold text-center mb-12">What We Believe</h1>
    <div className="space-y-6">
      {[
        { title: "The Holy Scriptures", content: "We believe the Bible is the inspired, infallible, and authoritative Word of God." },
        { title: "The Trinity", content: "We believe in one God, eternally existent in three persons: Father, Son, and Holy Spirit." },
        { title: "Salvation", content: "We believe that salvation is by grace through faith in the Lord Jesus Christ alone." },
        { title: "The Holy Spirit", content: "We believe in the present-day ministry of the Holy Spirit and the baptism of the Holy Spirit with the evidence of speaking in tongues." },
        { title: "Newness of Life", content: "We believe that every believer is a new creation (2 Cor 5:17) and is empowered to live a victorious life over sin and the world." }
      ].map((item, index) => (
        <div key={index} className="bg-white shadow-md rounded-lg p-6 border-l-4 border-blue-900">
          <h3 className="text-xl font-bold text-gray-800 mb-2">{item.title}</h3>
          <p className="text-gray-600">{item.content}</p>
        </div>
      ))}
    </div>
  </div>
);

const Leadership = () => (
  <div className="animate-fade-in py-16 px-4">
    <div className="max-w-6xl mx-auto">
      <h1 className="text-4xl font-bold text-center mb-4">Our Leadership</h1>
      <p className="text-center text-gray-600 mb-16 max-w-2xl mx-auto">Meet the anointed servants of God leading the vision of Newness of Life Incorporated.</p>
      
      {/* Main Leader */}
      <div className="flex flex-col md:flex-row items-center justify-center gap-12 mb-20">
        <div className="w-64 h-64 md:w-80 md:h-80 bg-gray-200 rounded-full overflow-hidden border-8 border-white shadow-xl">
          <img src="https://images.unsplash.com/photo-1560250097-0b93528c311a?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80" alt="Presiding Bishop" className="w-full h-full object-cover" />
        </div>
        <div className="text-center md:text-left">
          <h2 className="text-3xl font-bold text-blue-900">Presiding Bishop</h2>
          <p className="text-xl text-yellow-600 font-semibold mb-4">General Overseer</p>
          <p className="text-gray-600 max-w-md leading-relaxed">
            A visionary leader with a heart for the people of Tarkwa and the world. He is dedicated to teaching the unadulterated Word of God and raising giants in the Kingdom.
          </p>
        </div>
      </div>

      {/* Other Pastors */}
      <div className="grid grid-cols-1 md:grid-cols-3 gap-8">
        {[1, 2, 3].map((i) => (
          <div key={i} className="bg-white p-6 rounded-lg shadow-lg text-center">
            <div className="w-32 h-32 bg-gray-200 rounded-full mx-auto mb-4 overflow-hidden">
               <img src={`https://images.unsplash.com/photo-${i === 2 ? '1573496359142-b8d87734a5a2' : '1544005313-94ddf0286df2'}?ixlib=rb-1.2.1&auto=format&fit=crop&w=400&q=80`} alt="Pastor" className="w-full h-full object-cover" />
            </div>
            <h3 className="text-xl font-bold text-gray-800">Rev. Pastor Name</h3>
            <p className="text-blue-600 mb-2">Resident Pastor (Branch {i})</p>
            <p className="text-gray-500 text-sm">Serving with excellence and integrity.</p>
          </div>
        ))}
      </div>
    </div>
  </div>
);

const Ministries = () => (
  <div className="animate-fade-in max-w-6xl mx-auto py-16 px-4">
    <h1 className="text-4xl font-bold text-center mb-12">Our Ministries</h1>
    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
      {[
        { name: "Men of Valor", desc: "Empowering men to take their place as priests and kings in their homes and society.", icon: "ðŸ›¡ï¸" },
        { name: "Virtuous Women", desc: "A sisterhood of women growing in grace, prayer, and support for one another.", icon: "ðŸ‘‘" },
        { name: "New Gen Youth", desc: "Dynamic ministry for teenagers and young adults to express their faith.", icon: "ðŸ”¥" },
        { name: "Kingdom Kids", desc: "Building a solid biblical foundation for our children in a fun environment.", icon: "ðŸ‘¶" },
        { name: "Evangelism Team", desc: "The heartbeat of the church, taking the gospel to the streets of Tarkwa.", icon: "ðŸ“¢" },
        { name: "Worship Ministry", desc: "Leading the congregation into the deep presence of God through music.", icon: "ðŸŽµ" },
      ].map((min, idx) => (
        <div key={idx} className="bg-white p-8 rounded-xl shadow-md hover:shadow-xl transition border-t-4 border-blue-900">
          <div className="text-4xl mb-4">{min.icon}</div>
          <h3 className="text-xl font-bold mb-3">{min.name}</h3>
          <p className="text-gray-600">{min.desc}</p>
        </div>
      ))}
    </div>
  </div>
);

const GlobalMissions = () => (
  <div className="animate-fade-in py-16 px-4 bg-gray-50">
    <div className="max-w-5xl mx-auto">
      <div className="text-center mb-16">
        <h1 className="text-4xl font-bold text-gray-900 mb-4">Worldwide Impact</h1>
        <p className="text-xl text-gray-600">From Tarkwa to the Nations</p>
      </div>
      
      <div className="flex flex-col md:flex-row gap-12 items-center mb-16">
        <div className="flex-1">
          <div className="bg-white p-2 rounded-lg shadow-xl rotate-2 hover:rotate-0 transition duration-500">
             <img src="https://images.unsplash.com/photo-1526778548025-fa2f459cd5c1?ixlib=rb-1.2.1&auto=format&fit=crop&w=1000&q=80" alt="World Map" className="w-full rounded" />
          </div>
        </div>
        <div className="flex-1 space-y-6">
          <h3 className="text-2xl font-bold text-blue-900">Our Global Footprint</h3>
          <p className="text-gray-700">
            Newness of Life Incorporated is not just a local church; we are a global body. We currently have mission posts and fellowship centers in:
          </p>
          <ul className="space-y-3">
            <li className="flex items-center gap-3"><Globe size={20} className="text-blue-500"/> <strong>Ghana:</strong> Tarkwa (HQ), Accra, Kumasi, Takoradi</li>
            <li className="flex items-center gap-3"><Globe size={20} className="text-blue-500"/> <strong>Europe:</strong> London, Amsterdam (Fellowship Centers)</li>
            <li className="flex items-center gap-3"><Globe size={20} className="text-blue-500"/> <strong>North America:</strong> New York (Online Chapter)</li>
          </ul>
          <button className="bg-blue-900 text-white px-6 py-2 rounded-lg mt-4 hover:bg-blue-800 transition">Start a Fellowship Near You</button>
        </div>
      </div>
    </div>
  </div>
);

const Sermons = () => (
  <div className="animate-fade-in max-w-6xl mx-auto py-16 px-4">
    <h1 className="text-4xl font-bold text-center mb-12">Sermons & Media</h1>
    <div className="grid grid-cols-1 md:grid-cols-3 gap-8">
      {[1, 2, 3, 4, 5, 6].map((item) => (
        <div key={item} className="bg-white rounded-lg overflow-hidden shadow-lg group">
          <div className="relative">
            <img src={`https://images.unsplash.com/photo-1543791187-df796fa1103e?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60`} alt="Sermon thumbnail" className="w-full h-48 object-cover" />
            <div className="absolute inset-0 bg-black/40 flex items-center justify-center opacity-0 group-hover:opacity-100 transition duration-300">
              <PlayCircle className="text-white w-16 h-16" />
            </div>
          </div>
          <div className="p-6">
            <span className="text-xs font-bold text-blue-600 uppercase tracking-wide">Sunday Service</span>
            <h3 className="text-lg font-bold mt-2 mb-2">Walking in Dominion Pt. {item}</h3>
            <p className="text-gray-500 text-sm mb-4">Preached by Bishop at Tarkwa HQ</p>
            <button className="text-blue-900 font-semibold flex items-center text-sm hover:underline">
              Listen Audio <ChevronRight size={16} />
            </button>
          </div>
        </div>
      ))}
    </div>
  </div>
);

const Events = () => (
  <div className="animate-fade-in max-w-4xl mx-auto py-16 px-4">
    <h1 className="text-4xl font-bold text-center mb-12">Upcoming Events</h1>
    <div className="space-y-6">
      {[
        { date: "DEC 31", title: "Crossover Night Service", time: "9:00 PM", location: "Main Auditorium, Tarkwa" },
        { date: "JAN 21", title: "21 Days of Fasting & Prayer", time: "All Day", location: "Worldwide" },
        { date: "FEB 14", title: "Couples Love Feast", time: "6:00 PM", location: "Tarkwa Conference Center" },
      ].map((evt, idx) => (
        <div key={idx} className="flex flex-col md:flex-row bg-white rounded-xl shadow-md overflow-hidden hover:shadow-lg transition">
          <div className="bg-blue-900 text-white p-6 flex flex-col items-center justify-center md:w-32">
            <span className="text-lg font-bold opacity-80">{evt.date.split(' ')[0]}</span>
            <span className="text-3xl font-bold">{evt.date.split(' ')[1]}</span>
          </div>
          <div className="p-6 flex-1 flex flex-col justify-center">
            <h3 className="text-xl font-bold text-gray-800">{evt.title}</h3>
            <div className="flex items-center gap-4 mt-2 text-gray-600 text-sm">
              <span className="flex items-center gap-1"><Calendar size={14}/> {evt.time}</span>
              <span className="flex items-center gap-1"><MapPin size={14}/> {evt.location}</span>
            </div>
          </div>
          <div className="p-6 flex items-center">
            <button className="border border-blue-900 text-blue-900 px-4 py-2 rounded hover:bg-blue-900 hover:text-white transition">Register</button>
          </div>
        </div>
      ))}
    </div>
  </div>
);

const Contact = ({ user }) => {
  const [formData, setFormData] = useState({ name: '', email: '', subject: 'Prayer Request', message: '' });
  const [status, setStatus] = useState('idle'); // idle, submitting, success, error

  const handleSubmit = async (e) => {
    e.preventDefault();
    if (!user) {
      alert("Establishing secure connection... Please try again in a moment.");
      return;
    }
    
    setStatus('submitting');
    try {
      await addDoc(collection(db, 'artifacts', appId, 'public', 'data', 'contact_messages'), {
        ...formData,
        userId: user.uid,
        createdAt: serverTimestamp(),
        platform: 'web'
      });
      setStatus('success');
      setFormData({ name: '', email: '', subject: 'Prayer Request', message: '' });
      setTimeout(() => setStatus('idle'), 5000);
    } catch (error) {
      console.error("Error sending message:", error);
      setStatus('error');
    }
  };

  return (
    <div className="animate-fade-in py-16 px-4 bg-gray-50">
      <div className="max-w-6xl mx-auto grid grid-cols-1 md:grid-cols-2 gap-12">
        <div>
          <h1 className="text-4xl font-bold text-gray-900 mb-6">Contact Us</h1>
          <p className="text-gray-600 mb-8">We would love to hear from you. Visit our headquarters in Tarkwa or send us a message.</p>
          
          <div className="space-y-6">
            <div className="flex items-start gap-4">
              <div className="bg-blue-100 p-3 rounded-full"><MapPin className="text-blue-600"/></div>
              <div>
                <h3 className="font-bold text-gray-900">Headquarters Address</h3>
                <p className="text-gray-600">Newness of Life Incorporated,<br/>Near UMaT Campus Area,<br/>Tarkwa, Western Region, Ghana.</p>
              </div>
            </div>
            
            <div className="flex items-start gap-4">
              <div className="bg-blue-100 p-3 rounded-full"><Phone className="text-blue-600"/></div>
              <div>
                <h3 className="font-bold text-gray-900">Phone & WhatsApp</h3>
                <p className="text-gray-600">+233 24 000 0000<br/>+233 50 000 0000</p>
              </div>
            </div>

            <div className="flex items-start gap-4">
              <div className="bg-blue-100 p-3 rounded-full"><Mail className="text-blue-600"/></div>
              <div>
                <h3 className="font-bold text-gray-900">Email</h3>
                <p className="text-gray-600">info@newnessoflife.com</p>
              </div>
            </div>
          </div>

          <div className="mt-10">
            <h3 className="font-bold text-gray-900 mb-4">Follow Us</h3>
            <div className="flex gap-4">
              <button className="bg-blue-600 text-white p-3 rounded-full hover:bg-blue-700 transition"><Facebook size={20}/></button>
              <button className="bg-red-600 text-white p-3 rounded-full hover:bg-red-700 transition"><Youtube size={20}/></button>
              <button className="bg-pink-600 text-white p-3 rounded-full hover:bg-pink-700 transition"><Instagram size={20}/></button>
            </div>
          </div>
        </div>

        <div className="bg-white p-8 rounded-xl shadow-lg">
          <h3 className="text-2xl font-bold mb-6">Send a Message</h3>
          {status === 'success' ? (
             <div className="bg-green-50 text-green-800 p-8 rounded-lg text-center flex flex-col items-center justify-center h-80">
               <CheckCircle size={64} className="text-green-500 mb-4" />
               <h4 className="text-2xl font-bold mb-2">Message Sent!</h4>
               <p>Thank you for contacting Newness of Life. We will get back to you shortly.</p>
               <button onClick={() => setStatus('idle')} className="mt-6 text-green-700 font-bold underline">Send another</button>
             </div>
          ) : (
            <form onSubmit={handleSubmit} className="space-y-4">
              <div>
                <label className="block text-gray-700 mb-2">Full Name</label>
                <input 
                  type="text" 
                  required
                  value={formData.name}
                  onChange={(e) => setFormData({...formData, name: e.target.value})}
                  className="w-full p-3 border rounded-lg focus:outline-none focus:border-blue-500" 
                  placeholder="John Doe" 
                />
              </div>
              <div>
                <label className="block text-gray-700 mb-2">Email Address</label>
                <input 
                  type="email" 
                  required
                  value={formData.email}
                  onChange={(e) => setFormData({...formData, email: e.target.value})}
                  className="w-full p-3 border rounded-lg focus:outline-none focus:border-blue-500" 
                  placeholder="john@example.com" 
                />
              </div>
              <div>
                <label className="block text-gray-700 mb-2">Subject</label>
                <select 
                  value={formData.subject}
                  onChange={(e) => setFormData({...formData, subject: e.target.value})}
                  className="w-full p-3 border rounded-lg focus:outline-none focus:border-blue-500"
                >
                  <option>Prayer Request</option>
                  <option>General Inquiry</option>
                  <option>Testimony</option>
                  <option>Counseling</option>
                </select>
              </div>
              <div>
                <label className="block text-gray-700 mb-2">Message</label>
                <textarea 
                  required
                  value={formData.message}
                  onChange={(e) => setFormData({...formData, message: e.target.value})}
                  className="w-full p-3 border rounded-lg focus:outline-none focus:border-blue-500 h-32" 
                  placeholder="How can we help you?"
                ></textarea>
              </div>
              
              {status === 'error' && (
                <div className="bg-red-50 text-red-600 p-3 rounded">
                  Something went wrong. Please try again later.
                </div>
              )}

              <button 
                type="submit" 
                disabled={status === 'submitting' || !user}
                className="w-full bg-yellow-500 text-blue-900 font-bold py-3 rounded-lg hover:bg-yellow-400 transition disabled:opacity-50 flex items-center justify-center gap-2"
              >
                {status === 'submitting' ? <><Loader2 className="animate-spin" /> Sending...</> : 'Send Message'}
              </button>
            </form>
          )}
        </div>
      </div>
    </div>
  );
};

// --- Main App Component ---

export default function NewnessOfLifeApp() {
  const [currentPage, setCurrentPage] = useState('home');
  const [isMenuOpen, setIsMenuOpen] = useState(false);
  const [scrolled, setScrolled] = useState(false);
  const [user, setUser] = useState(null);

  useEffect(() => {
    // 1. Scroll Listener
    const handleScroll = () => setScrolled(window.scrollY > 50);
    window.addEventListener('scroll', handleScroll);

    // 2. Firebase Auth Initialization (Simulating backend connection)
    const initAuth = async () => {
      if (typeof __initial_auth_token !== 'undefined' && __initial_auth_token) {
        await signInWithCustomToken(auth, __initial_auth_token);
      } else {
        await signInAnonymously(auth);
      }
    };
    initAuth();

    // 3. Auth Listener
    const unsubscribe = onAuthStateChanged(auth, (currentUser) => {
      setUser(currentUser);
    });

    return () => {
      window.removeEventListener('scroll', handleScroll);
      unsubscribe();
    };
  }, []);

  const navigate = (page) => {
    setCurrentPage(page);
    setIsMenuOpen(false);
    window.scrollTo(0, 0);
  };

  const pages = {
    home: <Home navigate={navigate} />,
    about: <About />,
    beliefs: <Beliefs />,
    leadership: <Leadership />,
    ministries: <Ministries />,
    global: <GlobalMissions />,
    sermons: <Sermons />,
    events: <Events />,
    contact: <Contact user={user} />
  };

  const navLinks = [
    { id: 'home', label: 'Home' },
    { id: 'about', label: 'About Us' },
    { id: 'leadership', label: 'Leadership' },
    { id: 'ministries', label: 'Ministries' },
    { id: 'global', label: 'Global' },
    { id: 'sermons', label: 'Sermons' },
    { id: 'contact', label: 'Contact' },
  ];

  return (
    <div className="font-sans min-h-screen bg-gray-50 flex flex-col text-gray-800">
      
      {/* Navigation Bar */}
      <nav className={`fixed w-full z-50 transition-all duration-300 ${scrolled ? 'bg-white shadow-md py-2' : 'bg-blue-900/90 backdrop-blur-sm py-4 text-white'}`}>
        <div className="max-w-7xl mx-auto px-4 flex justify-between items-center">
          <div 
            onClick={() => navigate('home')} 
            className={`font-bold text-xl md:text-2xl cursor-pointer flex items-center gap-2 ${scrolled ? 'text-blue-900' : 'text-white'}`}
          >
            <Globe size={24} className="text-yellow-500" />
            <span>NEWNESS<span className="text-yellow-500">.</span></span>
          </div>

          {/* Desktop Nav */}
          <div className="hidden lg:flex gap-6 items-center">
            {navLinks.map((link) => (
              <button 
                key={link.id}
                onClick={() => navigate(link.id)}
                className={`text-sm font-semibold uppercase tracking-wider hover:text-yellow-500 transition ${scrolled ? 'text-gray-700' : 'text-gray-200'} ${currentPage === link.id ? 'text-yellow-500' : ''}`}
              >
                {link.label}
              </button>
            ))}
            <button onClick={() => navigate('contact')} className="bg-yellow-500 text-blue-900 px-5 py-2 rounded-full font-bold text-sm hover:bg-yellow-400 transition">
              Give Online
            </button>
          </div>

          {/* Mobile Menu Toggle */}
          <button className="lg:hidden" onClick={() => setIsMenuOpen(!isMenuOpen)}>
            {isMenuOpen ? <X className={scrolled ? 'text-gray-800' : 'text-white'} /> : <Menu className={scrolled ? 'text-gray-800' : 'text-white'} />}
          </button>
        </div>

        {/* Mobile Nav */}
        {isMenuOpen && (
          <div className="lg:hidden bg-white absolute top-full left-0 w-full shadow-xl border-t">
            <div className="flex flex-col p-4">
              {navLinks.map((link) => (
                <button 
                  key={link.id}
                  onClick={() => navigate(link.id)}
                  className={`py-3 text-left border-b border-gray-100 font-medium ${currentPage === link.id ? 'text-blue-600' : 'text-gray-700'}`}
                >
                  {link.label}
                </button>
              ))}
              <button className="bg-yellow-500 text-blue-900 py-3 mt-4 rounded font-bold">Give Online</button>
            </div>
          </div>
        )}
      </nav>

      {/* Main Content Area */}
      <main className="flex-grow pt-0">
        {pages[currentPage]}
      </main>

      {/* Footer */}
      <footer className="bg-blue-950 text-white py-12 px-4">
        <div className="max-w-7xl mx-auto grid grid-cols-1 md:grid-cols-4 gap-8">
          <div>
            <div className="flex items-center gap-2 font-bold text-2xl mb-4">
              <Globe className="text-yellow-500" /> NEWNESS.
            </div>
            <p className="text-gray-400 text-sm leading-relaxed">
              Newness of Life Incorporated is dedicated to raising a generation of believers who walk in the fullness of Christ's resurrection power.
            </p>
          </div>
          <div>
            <h4 className="font-bold text-lg mb-4">Quick Links</h4>
            <ul className="space-y-2 text-gray-400 text-sm">
              <li onClick={() => navigate('about')} className="cursor-pointer hover:text-yellow-500">About Us</li>
              <li onClick={() => navigate('ministries')} className="cursor-pointer hover:text-yellow-500">Ministries</li>
              <li onClick={() => navigate('events')} className="cursor-pointer hover:text-yellow-500">Events</li>
              <li onClick={() => navigate('contact')} className="cursor-pointer hover:text-yellow-500">Contact</li>
            </ul>
          </div>
          <div>
            <h4 className="font-bold text-lg mb-4">Service Times</h4>
            <ul className="space-y-2 text-gray-400 text-sm">
              <li>Sunday: 7:00 AM & 9:30 AM</li>
              <li>Wednesday: 6:00 PM</li>
              <li>Friday: 6:30 PM</li>
            </ul>
          </div>
          <div>
            <h4 className="font-bold text-lg mb-4">Subscribe</h4>
            <p className="text-gray-400 text-sm mb-4">Get the latest updates and sermons.</p>
            <div className="flex">
              <input type="email" placeholder="Email Address" className="bg-blue-900 border-none text-white px-4 py-2 rounded-l w-full focus:outline-none" />
              <button className="bg-yellow-500 text-blue-900 px-4 py-2 rounded-r font-bold hover:bg-yellow-400">Go</button>
            </div>
          </div>
        </div>
        <div className="border-t border-blue-900 mt-12 pt-8 text-center text-gray-500 text-sm">
          <p>&copy; 2025 Newness of Life Incorporated. All Rights Reserved. Tarkwa & Worldwide.</p>
        </div>
      </footer>
    </div>
  );
}